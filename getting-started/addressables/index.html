<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Addressables - Orbit</title>
<meta name="generator" content="Hugo 0.71.1" />
<link href="/orbitindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="/orbit/getting-started/addressables/">
<link rel="stylesheet" href="/orbit/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="/orbit/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="/orbit/js/bundle.js"></script><style>
:root {}
</style>
<meta property="og:title" content="Addressables" />
<meta property="og:description" content="In Orbit, an addressable is an object that interacts with the world through asynchronous messages. Simply, it has an address and can receive messages, even remotely.
Orbit will activate an addressable when it receives a message, and deactivate it when after a configurable period of inactivity. This patterns allows developers to speed up interactions and reduce load on databases and external services.
Orbit guarantees that only one addressable with a given identity can be active at any time in the cluster." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/orbit/getting-started/addressables/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Addressables"/>
<meta name="twitter:description" content="In Orbit, an addressable is an object that interacts with the world through asynchronous messages. Simply, it has an address and can receive messages, even remotely.
Orbit will activate an addressable when it receives a message, and deactivate it when after a configurable period of inactivity. This patterns allows developers to speed up interactions and reduce load on databases and external services.
Orbit guarantees that only one addressable with a given identity can be active at any time in the cluster."/>
<meta itemprop="name" content="Addressables">
<meta itemprop="description" content="In Orbit, an addressable is an object that interacts with the world through asynchronous messages. Simply, it has an address and can receive messages, even remotely.
Orbit will activate an addressable when it receives a message, and deactivate it when after a configurable period of inactivity. This patterns allows developers to speed up interactions and reduce load on databases and external services.
Orbit guarantees that only one addressable with a given identity can be active at any time in the cluster.">

<meta itemprop="wordCount" content="742">



<meta itemprop="keywords" content="" /></head>
<body><div class="container"><header>
<h1>Orbit</h1>

</header>

<div class="content-container">
<main><h1>Addressables</h1>
<p>In Orbit, an addressable is an object that interacts with the world through asynchronous messages. Simply, it has an address and can receive messages, even remotely.</p>
<p>Orbit will activate an addressable when it receives a message, and deactivate it when after a configurable period of inactivity. This patterns allows developers to speed up interactions and reduce load on databases and external services.</p>
<p>Orbit guarantees that only one addressable with a given identity can be active at any time in the cluster. As such, developers do not need to be concerned about keeping multiple activations/instances of an addressable synchronized with one another.</p>
<p>Orbit also guarantees that calls to addressables can never be processed in parallel, meaning developers do not need to worry about concurrent access to an addressable. Two calls to an addressable can not be processed in parallel.</p>
<h2 id="addressable-interfaces">Addressable Interfaces</h2>
<p>Before you can implement an addressable you must create an interface for it.</p>
<h4 id="using-a-suspend-method">Using a suspend method</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">package</span> sample.addressables

<span style="color:#66d9ef">import</span> orbit.client.addressable.Addresable
 
<span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Greeter</span> : Addressable {
    <span style="color:#66d9ef">suspend</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">hello</span>(message: String): String
}
</code></pre></div><h4 id="using-a-java-promise">Using a Java promise</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">package</span> sample.addressables

<span style="color:#66d9ef">import</span> kotlinx.coroutines.Deferred
<span style="color:#66d9ef">import</span> orbit.client.addressable.Addresable
 
<span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Greeter</span> : Addressable {
    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">hello</span>(message: String): Deferred&lt;String&gt;
}
</code></pre></div><h2 id="asynchronous-return-types">Asynchronous Return Types</h2>
<p>Addressables must only contain methods which return asynchronous types, such as promises, or be Kotlin suspending methods.
The following return types (and their subtypes) are currently supported.</p>
<table>
<thead>
<tr>
<th align="left">Main Type</th>
<th align="left">Common Subtypes</th>
<th align="left">For</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-deferred/">Deferred</a></td>
<td align="left"><a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-completable-deferred/">CompletableDeferred</a></td>
<td align="left">Kotlin</td>
</tr>
<tr>
<td align="left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletionStage.html">CompletionStage</a></td>
<td align="left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html">CompletableFuture</a></td>
<td align="left">JDK8+</td>
</tr>
<tr>
<td align="left"><a href="https://kotlinlang.org/docs/reference/coroutines/composing-suspending-functions.html">Suspend</a></td>
<td align="left">N/A</td>
<td align="left">Kotlin</td>
</tr>
</tbody>
</table>
<h2 id="concrete-implementation">Concrete Implementation</h2>
<p>Once you have created an Addressable interface, you must offer an implementation for Orbit to use. For each addressable interface, exactly one addressable class must implement it.</p>
<h4 id="using-suspending-methods">Using suspending methods</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">package</span> sample.addressables

<span style="color:#66d9ef">import</span> orbit.client.addressables.AbstractAddressable
<span style="color:#66d9ef">import</span> sample.addressables.Greeter
 
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GreeterImpl</span>() : AbstractAddressable(), Greeter {
{
    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">suspend</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">hello</span>(message: String): String {
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Message: ${message}&#34;</span>
    }
}
</code></pre></div><h4 id="using-a-java-promise-1">Using a Java promise</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">package</span> sample.addressables

<span style="color:#66d9ef">import</span> kotlinx.coroutines.Deferred
<span style="color:#66d9ef">import</span> kotlinx.coroutines.CompletableDeferred
<span style="color:#66d9ef">import</span> orbit.client.addressables.AbstractAddressable
<span style="color:#66d9ef">import</span> sample.addressables.Greeter
 
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GreeterImpl</span>() : AbstractAddressable(), Greeter {
{
    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">hello</span>(message: String): Deferred&lt;String&gt; {
        <span style="color:#66d9ef">return</span> CompletableDeferred(<span style="color:#e6db74">&#34;Message: ${message}&#34;</span>)
    }
}
</code></pre></div><h2 id="lifetime">Lifetime</h2>
<p>When a message is sent to a given addressable reference, the framework will perform the following actions:</p>
<ol>
<li>Check if the addressable is already activated in the cluster
<ul>
<li>If so, forward the message to the client</li>
<li>If not, proceed to step 2</li>
</ul>
</li>
<li>Activate the addressable for the addressable type and place on a connected client</li>
<li>Call the OnActivate hook to initialize any state, such as restoring from persistence</li>
<li>Forward the message to the addressable</li>
</ol>
<p>Orbit does not provide any default persistence functionality, but the <code>@OnActivate</code> hook is available to restore state from a store before it receives the message.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GreeterImpl</span>() : AbstractAddressable(), Game {
{
    @OnActivate
    <span style="color:#66d9ef">suspend</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">onActivate</span>() {
        loadFromStore()
    }

    @OnDeactivate
    <span style="color:#66d9ef">suspend</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">onDeactivate</span>(deactivationReason: DeactivationReason) {
        saveToStore()
    }
}
</code></pre></div><p>Addressables can be persisted at any time, but the @OnDeactivate hook can help assure the latest state is saved, except in the event of an hard shutdown. During graceful shutdown, every actor is deactivated giving it a final chance to persist. Activate and Deactivate methods can similarly utilize a Java promise by returning a <code>Deferred&lt;Unit&gt;</code>.</p>
<h2 id="execution-model">Execution Model</h2>
<p>Addressables in Orbit can have multiple different execution modes. By default, addressables will use Safe Execution Mode.</p>
<h3 id="safe-execution-mode">Safe Execution Mode</h3>
<p>In safe execution mode Orbit guarantees that calls to addressables can never be processed in parallel. This means that if two clients call an addressable at the same time, they are guaranteed to be processed serially (one after the other) where one call completes before the next one starts.</p>
<p>Orbit guarantees &ldquo;at most once&rdquo; delivery, meaning that best attempts will be made to deliver a message one time, but will deliver an error upon failure to deliver.</p>
<h2 id="context">Context</h2>
<p>If an Addressable extends the AbstractAddressable or AbstractActor class, it will have access to an Orbit-managed context object. The AddressableContext provides access to the AddressableReference (identifier) and the OrbitClient instance. The AddressableReference can be used during the @OnActivate hook to identify which addressable needs to be restored from persistence.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AbstractAddressable</span> {
    <span style="color:#66d9ef">lateinit</span> <span style="color:#66d9ef">var</span> context: AddressableContext
}

<span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AddressableContext</span>(
    <span style="color:#66d9ef">val</span> reference: AddressableReference,
    <span style="color:#66d9ef">val</span> client: OrbitClient
)
</code></pre></div><p>For example, if the addressable is an Actor with a String-type key,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IdentityActor</span> : ActorWithStringKey {
    <span style="color:#66d9ef">suspend</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">identity</span>(): String
}

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">IdentityActorImpl</span>() : IdentityActor, AbstractActor() {
    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">suspend</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">identity</span>(): String {
        <span style="color:#66d9ef">val</span> id = context.reference
        <span style="color:#66d9ef">return</span> context.actorFactory.createProxy&lt;IdentityResolver&gt;().resolve(id)
    }
}
</code></pre></div><h2 id="keys">Keys</h2>
<p>Every addressable in Orbit has a unique key of one of the following types which identifies it.</p>
<table>
<thead>
<tr>
<th>Orbit Type</th>
<th>JDK Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>NoKey</td>
<td>N/A</td>
</tr>
<tr>
<td>StringKey</td>
<td>String</td>
</tr>
<tr>
<td>Int32Key</td>
<td>Integer</td>
</tr>
<tr>
<td>Int64Key</td>
<td>Long</td>
</tr>
</tbody>
</table>
<div class="edit-meta">

<br></div><nav class="pagination"><a class="nav nav-prev" href="/orbit/getting-started/modules/" title="Modules"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Modules</a>
<a class="nav nav-next" href="/orbit/getting-started/actors/" title="Actors">Next - Actors <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">

<nav class="open-menu">
<ul>
<li class=""><a href="/orbit">Home</a></li>

<li class="parent"><a href="/orbit/getting-started/">Getting Started</a>
  
<ul class="sub-menu">
<li class=""><a href="/orbit/getting-started/prerequisites/">Prerequisites</a></li>
<li class=""><a href="/orbit/getting-started/hello-world/">Hello World</a></li>
<li class=""><a href="/orbit/getting-started/modules/">Modules</a></li>
<li class="active"><a href="/orbit/getting-started/addressables/">Addressables</a></li>
<li class=""><a href="/orbit/getting-started/actors/">Actors</a></li>
<li class=""><a href="/orbit/getting-started/migration-from-1.x/">Migration from Orbit 1.x</a></li>
</ul>
  
</li>

<li class=""><a href="/orbit/client/">Client</a>
  
<ul class="sub-menu">
<li class=""><a href="/orbit/client/configuration/">Client Configuration</a></li>
<li class=""><a href="/orbit/client/dependency-injection/">Dependency Injection</a></li>
<li class=""><a href="/orbit/client/shutdown/">Shutdown</a></li>
</ul>
  
</li>

<li class=""><a href="/orbit/server/">Server</a>
  
<ul class="sub-menu">
<li class=""><a href="/orbit/server/configuration/">Server Configuration</a></li>
<li class=""><a href="/orbit/server/hosting/">Hosting Orbit Server</a></li>
</ul>
  
</li>

<li class=""><a href="/orbit/contributing/">Contributing</a>
  
<ul class="sub-menu">
<li class=""><a href="/orbit/contributing/governance/">Governance</a></li>
<li class=""><a href="/orbit/contributing/standards-and-policies/">Standards &amp; Policies</a></li>
<li class=""><a href="/orbit/contributing/legal/">Legal</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
